# -*- coding: utf-8 -*-
"""
Created on Sun Oct 16 22:29:26 2016
@author: Rong Huangfu
1206 Notes:

Dec. 1, DUET 1.1.0: update risk vs damage relationship
Feb. 12, 2018: DUET 1.2.0, update damage per cycle and the related damage-risk relationship
Apr. 11, 2018: DUET 1.3.0, update damage per cycle and the related damage-risk relationship with rounding correction
"""
import math

class DUET(object):

    def __init__(self, scale, rep):
        import colorsys

        self.scale = scale
        self.rep = rep

        #version 1.1.0
        #self.Borg_Scale_index = [0, 0.0000005, 0.000001, 0.0000015, 0.0000065, 0.00002105, 0.00007692, 0.00026667,
        #                         0.00040000, 0.00095238, 0.00150000, 0.00333333]

        # version 1.2.0
        #self.Borg_Scale_index = [0, 0.00000025, 0.00000043, 0.0000013, 0.00000394, 0.00001189, 0.00003591, 0.00010844, 0.00032744, 0.00098876, 0.00298573, 0.00901592]

        # version 1.3.0
        self.Borg_Scale_index = [0.00000026, 0.00000045, 0.00000137, 0.00000413, 0.00001262, 0.00003801, 0.00011625, 0.00035014, 0.00105374, 0.00322581, 0.00970874]


        # risk reference list and damage reference list are linked together with same length and in increasing order

        '''
        self.risk_reference = ['0.00424736', '0.008674928', '0.012287936', '0.012626433', '0.012626433', '0.013249801', '0.013425717', '0.013425717', '0.013425717', '0.01538984', '0.01538984', '0.016577687', '0.017142479', '0.017142479', '0.017509439', '0.017509439', '0.018222364', '0.018867518', '0.018867518', '0.019737043', '0.019737043', '0.020058845', '0.020058845', '0.020058845', '0.020454307', '0.021599159', '0.022041148', '0.022041148', '0.022041148', '0.022041148', '0.022041148', '0.023729996', '0.02751554', '0.02751554', '0.035272059', '0.036782954', '0.036782954', '0.036959219', '0.040555935', '0.040555935', '0.040821868', '0.040821868', '0.041609293', '0.042591744', '0.043327671', '0.044471923', '0.047498042', '0.047498042', '0.048095305', '0.048374372', '0.048374372', '0.049027258', '0.050531656', '0.054095953', '0.054095953', '0.055559418', '0.055559418', '0.057805321', '0.057805321', '0.058177503', '0.058177503', '0.059238612', '0.059987996', '0.061998487', '0.063396673', '0.063396673', '0.063396673', '0.063396673', '0.064270408', '0.067922149', '0.06799175', '0.06799175', '0.070264992', '0.070264992', '0.071966659', '0.072523986', '0.072523986', '0.072616409', '0.076750556', '0.076750556', '0.077360456', '0.077360456', '0.078192836', '0.079241958', '0.080859212', '0.081897976', '0.082794602', '0.082794602', '0.082794602', '0.082794602', '0.083238737', '0.08344363', '0.08344363', '0.083700149', '0.083700149', '0.084164114', '0.084164114', '0.084164114', '0.084264534', '0.084446194', '0.084446194', '0.087118388', '0.087118388', '0.088229842', '0.088308605', '0.088308605', '0.088308605', '0.088308605', '0.088716243', '0.088716243', '0.089189055', '0.089189055', '0.091770896', '0.091770896', '0.094371712', '0.094371712', '0.094914708', '0.095084772', '0.095084772', '0.095084772', '0.095084772', '0.095084772', '0.095084772', '0.095084772', '0.097600237', '0.097600237', '0.09807535', '0.09807535', '0.098783949', '0.098783949', '0.098783949', '0.098783949', '0.098783949', '0.098783949', '0.100572192', '0.100572192', '0.100572192', '0.100572192', '0.100572192', '0.100572192', '0.103048676', '0.103696877', '0.104460207', '0.104460207', '0.104460207', '0.105717371', '0.105717371', '0.105717371', '0.105717371', '0.105717371', '0.105717371', '0.105717371', '0.105717371', '0.10817772', '0.109780016', '0.109780016', '0.109780016', '0.109780016', '0.109780016', '0.110570308', '0.111742635', '0.112953143', '0.112953143', '0.11315479', '0.115169936', '0.115169936', '0.115169936', '0.115169936', '0.115169936', '0.11600679', '0.11600679', '0.11600679', '0.11600679', '0.117384701', '0.118373973', '0.122446795', '0.123371298', '0.123371298', '0.123727526', '0.123727526', '0.124145983', '0.124145983', '0.124145983', '0.124145983', '0.124946373', '0.126285906', '0.126285906', '0.127731479', '0.127731479', '0.127731479', '0.127731479', '0.127731479', '0.131576539', '0.131576539', '0.132514753', '0.132514753', '0.132514753', '0.132938296', '0.132938296', '0.132938296', '0.132938296', '0.132963338', '0.134059007', '0.135795131', '0.135969858', '0.135969858', '0.135969858', '0.135969858', '0.135969858', '0.137077845', '0.138534555', '0.138846796', '0.138846796', '0.138846796', '0.139828505', '0.139828505', '0.141158724', '0.141158724', '0.141444092', '0.141444092', '0.141964074', '0.141964074', '0.143977609', '0.145450371', '0.145450371', '0.145633019', '0.145633019', '0.145633019', '0.145633019', '0.148228613', '0.148645188', '0.148645188', '0.150762197', '0.15097064', '0.151442873', '0.151442873', '0.151442873', '0.151813301', '0.151813301', '0.153542643', '0.153542643', '0.156253427', '0.157289689', '0.157289689', '0.158023925', '0.159609094', '0.159609094', '0.161800499', '0.161800499', '0.16232967', '0.163728657', '0.163728657', '0.163728657', '0.163728657', '0.163728657', '0.163728657', '0.163728657', '0.163728657', '0.163728657', '0.166011152', '0.166011152', '0.166701298', '0.167660488', '0.167660488', '0.168409169', '0.170116675', '0.170116675', '0.171257762', '0.171452748', '0.172012232', '0.172422748', '0.172422748', '0.172422748', '0.172422748', '0.172469856', '0.173809599', '0.173809599', '0.174619753', '0.174619753', '0.175180017', '0.175180017', '0.175389421', '0.175389421', '0.177339617', '0.177339617', '0.179298269', '0.179298269', '0.180506037', '0.183472483', '0.183472483', '0.183853995', '0.183853995', '0.183853995', '0.183853995', '0.183853995', '0.183853995', '0.183853995', '0.183853995', '0.185013438', '0.185601717', '0.185601717', '0.186595193', '0.186595193', '0.186595193', '0.186595193', '0.187401951', '0.188632629', '0.188632629', '0.188632629', '0.188632629', '0.188632629', '0.189888726', '0.191012457', '0.191012457', '0.191953638', '0.191953638', '0.191953638', '0.191953638', '0.192498392', '0.192498392', '0.192617646', '0.192617646', '0.193179331', '0.193179331', '0.193369646', '0.193369646', '0.195186191', '0.195186191', '0.195186191', '0.196712615', '0.196712615', '0.19729468', '0.19729468', '0.19729468', '0.19729468', '0.19801343', '0.200199017', '0.200199017', '0.2002877', '0.2002877', '0.202111998', '0.202969104', '0.202969104', '0.202969104', '0.202969104', '0.204073491', '0.204073491', '0.204073491', '0.204073491', '0.204402909', '0.205140936', '0.205140936', '0.205140936', '0.212985356', '0.213511081', '0.213511081', '0.214360774', '0.214360774', '0.214360774', '0.214360774', '0.214360774', '0.214360774', '0.214360774', '0.214360774', '0.214360774', '0.215075342', '0.215480401', '0.215480401', '0.215523268', '0.215523268', '0.216876387', '0.216876387', '0.21732892', '0.21732892', '0.218987947', '0.220918498', '0.220918498', '0.221024124', '0.221024124', '0.221024124', '0.221024124', '0.222933879', '0.222933879', '0.226096836', '0.226096836', '0.227359749', '0.227359749', '0.227359749', '0.227807059', '0.227807059', '0.227807059', '0.229846502', '0.229854928', '0.229854928', '0.229854928', '0.229854928', '0.229854928', '0.230750581', '0.230750581', '0.230750581', '0.230750581', '0.231018086', '0.231018086', '0.231018086', '0.231018086', '0.231018086', '0.231018086', '0.231018086', '0.231018086', '0.231018086', '0.231962138', '0.231962138', '0.235864329', '0.237552824', '0.237552824', '0.238259321', '0.238259321', '0.241048248', '0.241048248', '0.241048248', '0.241048248', '0.241048248', '0.241048248', '0.242250231', '0.243225665', '0.243225665', '0.244953284', '0.245070563', '0.245070563', '0.245183156', '0.245183156', '0.245183156', '0.245183156', '0.245183156', '0.248621929', '0.248621929', '0.248621929', '0.250027297', '0.250374243', '0.250847566', '0.250847566', '0.251065463', '0.251065463', '0.251371537', '0.251371537', '0.251371537', '0.251371537', '0.251371537', '0.251371537', '0.252164091', '0.252164091', '0.252164091', '0.252164091', '0.252607864', '0.252607864', '0.255303064', '0.255303064', '0.25625036', '0.25625036', '0.256873951', '0.256873951', '0.257789734', '0.259095443', '0.259095443', '0.259095443', '0.260556517', '0.260556517', '0.260556517', '0.260556517', '0.261669845', '0.262546409', '0.263254494', '0.263254494', '0.263254494', '0.263254494', '0.26500445', '0.26500445', '0.265103856', '0.265690408', '0.265690408', '0.266149514', '0.266984311', '0.269149555', '0.269149555', '0.269149555', '0.269149555', '0.269916755', '0.269916755', '0.269916755', '0.269916755', '0.273130446', '0.273130446', '0.274367849', '0.274367849', '0.274367849', '0.27549247', '0.279711478', '0.282345751', '0.282345751', '0.282345751', '0.285807562', '0.285807562', '0.287594798', '0.287594798', '0.287594798', '0.287594798', '0.287594798', '0.288304965', '0.289301441', '0.289301441', '0.289301441', '0.289301441', '0.289301441', '0.289301441', '0.289301441', '0.289301441', '0.291245068', '0.29174718', '0.29174718', '0.29174718', '0.292653414', '0.293175405', '0.295100425', '0.295115724', '0.295115724', '0.2968484', '0.2968484', '0.297699464', '0.297699464', '0.298067635', '0.298067635', '0.298067635', '0.298067635', '0.298719786', '0.298719786', '0.299125848', '0.299125848', '0.299125848', '0.299125848', '0.299254355', '0.299756972', '0.300872019', '0.300872019', '0.30225351', '0.30225351', '0.303373821', '0.303373821', '0.304052588', '0.304052588', '0.306818453', '0.306818453', '0.307766403', '0.307766403', '0.309216633', '0.309668847', '0.309668847', '0.309668847', '0.309668847', '0.310107116', '0.310107116', '0.310269556', '0.310296195', '0.310296195', '0.311240294', '0.312462863', '0.314113153', '0.314113153', '0.314113153', '0.314113153', '0.314113153', '0.315528004', '0.315695266', '0.315695266', '0.3196897', '0.3196897', '0.320651422', '0.320651422', '0.323562315', '0.323971041', '0.323971041', '0.324798178', '0.324798178', '0.324798178', '0.327663907', '0.327663907', '0.327994914', '0.327994914', '0.328224725', '0.328224725', '0.330507357', '0.330615594', '0.331908053', '0.331908053', '0.33398359', '0.33398359', '0.335214545', '0.335214545', '0.335214545', '0.335214545', '0.337376987', '0.337376987', '0.338019773', '0.341305059', '0.341305059', '0.343090538', '0.343523554', '0.347722973', '0.347722973', '0.347722973', '0.348869858', '0.349212134', '0.349212134', '0.349212134', '0.350911308', '0.360386549', '0.360386549', '0.364625792', '0.364625792', '0.364625792', '0.365051372', '0.365051372', '0.365306112', '0.365306112', '0.367928801', '0.367928801', '0.368278202', '0.371969054', '0.371969054', '0.37474335', '0.376594292', '0.376594292', '0.377888549', '0.377888549', '0.377888549', '0.381668169', '0.381668169', '0.388292012', '0.388292012', '0.388503172', '0.388503172', '0.396634035', '0.397201376', '0.401475921', '0.401475921', '0.402266676', '0.402266676', '0.402266676', '0.402266676', '0.402266676', '0.405848297', '0.405848297', '0.412706446', '0.412706446', '0.415950269', '0.415950269', '0.419329883', '0.419329883', '0.422514893', '0.439268009', '0.439268009', '0.447969753', '0.448259605', '0.448259605', '0.456288848', '0.458077029', '0.458077029', '0.460929148', '0.470125109', '0.472168968', '0.472168968', '0.472168968', '0.474525405', '0.474525405', '0.475822032', '0.480800604', '0.489392374', '0.491666401', '0.491666401', '0.491666401', '0.491666401', '0.492094165', '0.492094165', '0.494914776', '0.494914776', '0.495872956', '0.495872956', '0.498335702', '0.501595115', '0.501785452', '0.501785452', '0.510112826', '0.510112826', '0.510112826', '0.510112826', '0.511815255', '0.512158361', '0.512158361', '0.5182094', '0.519378115', '0.519378115', '0.53010013', '0.531010217', '0.531010217', '0.539486755', '0.539486755', '0.539486755', '0.539486755', '0.542225068', '0.542225068', '0.542433256', '0.542433256', '0.545064403', '0.545064403', '0.545064403', '0.549509674', '0.549509674', '0.551671951', '0.551671951', '0.551671951', '0.551671951', '0.551671951', '0.551671951', '0.554894348', '0.554894348', '0.558944331', '0.558944331', '0.563294222', '0.563294222', '0.563294222', '0.564536748', '0.564536748', '0.564536748', '0.565388042', '0.565388042', '0.565388042', '0.56575657', '0.56575657', '0.566004854', '0.574976338', '0.578527571', '0.578527571', '0.578527571', '0.578527571', '0.579582496', '0.580888099', '0.582402619', '0.592029644', '0.598236703', '0.598236703', '0.599756988', '0.599756988', '0.600233599', '0.600233599', '0.600233599', '0.600233599', '0.602196285', '0.603683419', '0.605394205', '0.605394205', '0.606960032', '0.606960032', '0.608941912', '0.608941912', '0.608941912', '0.61735022', '0.624219064', '0.624219064', '0.625367202', '0.627883304', '0.627883304', '0.628142965', '0.628142965', '0.628142965', '0.628142965', '0.628142965', '0.630910301', '0.630910301', '0.632342773', '0.632967079', '0.632967079', '0.636611383', '0.6378381', '0.6378381', '0.6378381', '0.6378381', '0.648146359', '0.666258248', '0.666258248', '0.677137971', '0.677137971', '0.680178305', '0.680178305', '0.689325055', '0.689325055', '0.715500304', '0.715500304', '0.71998118', '0.743294329', '0.849947448', '0.849947448', '0.849947448', '0.911017461']

        self.damage_reference = ['0.0000133', '0.0000520', '0.0001013', '0.0001067', '0.0001067', '0.0001170', '0.0001200', '0.0001200', '0.0001200', '0.0001560', '0.0001560', '0.0001800', '0.0001920', '0.0001920', '0.0002000', '0.0002000', '0.0002160', '0.0002310', '0.0002310', '0.0002520', '0.0002520', '0.0002600', '0.0002600', '0.0002600', '0.0002700', '0.0003000', '0.0003120', '0.0003120', '0.0003120', '0.0003120', '0.0003120', '0.0003600', '0.0004800', '0.0004800', '0.0007800', '0.0008470', '0.0008470', '0.0008550', '0.0010267', '0.0010267', '0.0010400', '0.0010400', '0.0010800', '0.0011310', '0.0011700', '0.0012320', '0.0014040', '0.0014040', '0.0014393', '0.0014560', '0.0014560', '0.0014954', '0.0015882', '0.0018200', '0.0018200', '0.0019200', '0.0019200', '0.0020790', '0.0020790', '0.0021060', '0.0021060', '0.0021840', '0.0022400', '0.0023940', '0.0025043', '0.0025043', '0.0025043', '0.0025043', '0.0025747', '0.0028800', '0.0028860', '0.0028860', '0.0030857', '0.0030857', '0.0032400', '0.0032914', '0.0032914', '0.0033000', '0.0036960', '0.0036960', '0.0037565', '0.0037565', '0.0038400', '0.0039467', '0.0041143', '0.0042240', '0.0043200', '0.0043200', '0.0043200', '0.0043200', '0.0043680', '0.0043902', '0.0043902', '0.0044182', '0.0044182', '0.0044690', '0.0044690', '0.0044690', '0.0044800', '0.0045000', '0.0045000', '0.0048000', '0.0048000', '0.0049280', '0.0049371', '0.0049371', '0.0049371', '0.0049371', '0.0049846', '0.0049846', '0.0050400', '0.0050400', '0.0053486', '0.0053486', '0.0056700', '0.0056700', '0.0057385', '0.0057600', '0.0057600', '0.0057600', '0.0057600', '0.0057600', '0.0057600', '0.0057600', '0.0060840', '0.0060840', '0.0061463', '0.0061463', '0.0062400', '0.0062400', '0.0062400', '0.0062400', '0.0062400', '0.0062400', '0.0064800', '0.0064800', '0.0064800', '0.0064800', '0.0064800', '0.0064800', '0.0068211', '0.0069120', '0.0070200', '0.0070200', '0.0070200', '0.0072000', '0.0072000', '0.0072000', '0.0072000', '0.0072000', '0.0072000', '0.0072000', '0.0072000', '0.0075600', '0.0078000', '0.0078000', '0.0078000', '0.0078000', '0.0078000', '0.0079200', '0.0081000', '0.0082884', '0.0082884', '0.0083200', '0.0086400', '0.0086400', '0.0086400', '0.0086400', '0.0086400', '0.0087750', '0.0087750', '0.0087750', '0.0087750', '0.0090000', '0.0091636', '0.0098560', '0.0100174', '0.0100174', '0.0100800', '0.0100800', '0.0101538', '0.0101538', '0.0101538', '0.0101538', '0.0102960', '0.0105366', '0.0105366', '0.0108000', '0.0108000', '0.0108000', '0.0108000', '0.0108000', '0.0115200', '0.0115200', '0.0117000', '0.0117000', '0.0117000', '0.0117818', '0.0117818', '0.0117818', '0.0117818', '0.0117867', '0.0120000', '0.0123429', '0.0123777', '0.0123777', '0.0123777', '0.0123777', '0.0123777', '0.0126000', '0.0128960', '0.0129600', '0.0129600', '0.0129600', '0.0131625', '0.0131625', '0.0134400', '0.0134400', '0.0135000', '0.0135000', '0.0136098', '0.0136098', '0.0140400', '0.0143600', '0.0143600', '0.0144000', '0.0144000', '0.0144000', '0.0144000', '0.0149760', '0.0150698', '0.0150698', '0.0155520', '0.0156000', '0.0157091', '0.0157091', '0.0157091', '0.0157950', '0.0157950', '0.0162000', '0.0162000', '0.0168480', '0.0171000', '0.0171000', '0.0172800', '0.0176727', '0.0176727', '0.0182250', '0.0182250', '0.0183600', '0.0187200', '0.0187200', '0.0187200', '0.0187200', '0.0187200', '0.0187200', '0.0187200', '0.0187200', '0.0187200', '0.0193171', '0.0193171', '0.0195000', '0.0197561', '0.0197561', '0.0199575', '0.0204218', '0.0204218', '0.0207360', '0.0207900', '0.0209455', '0.0210600', '0.0210600', '0.0210600', '0.0210600', '0.0210732', '0.0214500', '0.0214500', '0.0216800', '0.0216800', '0.0218400', '0.0218400', '0.0219000', '0.0219000', '0.0224640', '0.0224640', '0.0230400', '0.0230400', '0.0234000', '0.0243000', '0.0243000', '0.0244174', '0.0244174', '0.0244174', '0.0244174', '0.0244174', '0.0244174', '0.0244174', '0.0244174', '0.0247765', '0.0249600', '0.0249600', '0.0252720', '0.0252720', '0.0252720', '0.0252720', '0.0255273', '0.0259200', '0.0259200', '0.0259200', '0.0259200', '0.0259200', '0.0263250', '0.0266909', '0.0266909', '0.0270000', '0.0270000', '0.0270000', '0.0270000', '0.0271800', '0.0271800', '0.0272195', '0.0272195', '0.0274061', '0.0274061', '0.0274696', '0.0274696', '0.0280800', '0.0280800', '0.0280800', '0.0286000', '0.0286000', '0.0288000', '0.0288000', '0.0288000', '0.0288000', '0.0290483', '0.0298122', '0.0298122', '0.0298435', '0.0298435', '0.0304920', '0.0308000', '0.0308000', '0.0308000', '0.0308000', '0.0312000', '0.0312000', '0.0312000', '0.0312000', '0.0313200', '0.0315900', '0.0315900', '0.0315900', '0.0345600', '0.0347657', '0.0347657', '0.0351000', '0.0351000', '0.0351000', '0.0351000', '0.0351000', '0.0351000', '0.0351000', '0.0351000', '0.0351000', '0.0353829', '0.0355439', '0.0355439', '0.0355610', '0.0355610', '0.0361029', '0.0361029', '0.0362854', '0.0362854', '0.0369600', '0.0377561', '0.0377561', '0.0378000', '0.0378000', '0.0378000', '0.0378000', '0.0386000', '0.0386000', '0.0399512', '0.0399512', '0.0405000', '0.0405000', '0.0405000', '0.0406957', '0.0406957', '0.0406957', '0.0415963', '0.0416000', '0.0416000', '0.0416000', '0.0416000', '0.0416000', '0.0420000', '0.0420000', '0.0420000', '0.0420000', '0.0421200', '0.0421200', '0.0421200', '0.0421200', '0.0421200', '0.0421200', '0.0421200', '0.0421200', '0.0421200', '0.0425455', '0.0425455', '0.0443368', '0.0451286', '0.0451286', '0.0454629', '0.0454629', '0.0468000', '0.0468000', '0.0468000', '0.0468000', '0.0468000', '0.0468000', '0.0473850', '0.0478636', '0.0478636', '0.0487200', '0.0487785', '0.0487785', '0.0488348', '0.0488348', '0.0488348', '0.0488348', '0.0488348', '0.0505756', '0.0505756', '0.0505756', '0.0513000', '0.0514800', '0.0517263', '0.0517263', '0.0518400', '0.0518400', '0.0520000', '0.0520000', '0.0520000', '0.0520000', '0.0520000', '0.0520000', '0.0524160', '0.0524160', '0.0524160', '0.0524160', '0.0526500', '0.0526500', '0.0540878', '0.0540878', '0.0546000', '0.0546000', '0.0549391', '0.0549391', '0.0554400', '0.0561600', '0.0561600', '0.0561600', '0.0569739', '0.0569739', '0.0569739', '0.0569739', '0.0576000', '0.0580966', '0.0585000', '0.0585000', '0.0585000', '0.0585000', '0.0595061', '0.0595061', '0.0595636', '0.0599040', '0.0599040', '0.0601714', '0.0606600', '0.0619412', '0.0619412', '0.0619412', '0.0619412', '0.0624000', '0.0624000', '0.0624000', '0.0624000', '0.0643500', '0.0643500', '0.0651130', '0.0651130', '0.0651130', '0.0658125', '0.0684878', '0.0702000', '0.0702000', '0.0702000', '0.0725000', '0.0725000', '0.0737100', '0.0737100', '0.0737100', '0.0737100', '0.0737100', '0.0741951', '0.0748800', '0.0748800', '0.0748800', '0.0748800', '0.0748800', '0.0748800', '0.0748800', '0.0748800', '0.0762300', '0.0765818', '0.0765818', '0.0765818', '0.0772200', '0.0775895', '0.0789640', '0.0789750', '0.0789750', '0.0802286', '0.0802286', '0.0808500', '0.0808500', '0.0811200', '0.0811200', '0.0811200', '0.0811200', '0.0816000', '0.0816000', '0.0819000', '0.0819000', '0.0819000', '0.0819000', '0.0819951', '0.0823680', '0.0832000', '0.0832000', '0.0842400', '0.0842400', '0.0850909', '0.0850909', '0.0856098', '0.0856098', '0.0877500', '0.0877500', '0.0884932', '0.0884932', '0.0896400', '0.0900000', '0.0900000', '0.0900000', '0.0900000', '0.0903500', '0.0903500', '0.0904800', '0.0905013', '0.0905013', '0.0912600', '0.0922500', '0.0936000', '0.0936000', '0.0936000', '0.0936000', '0.0936000', '0.0947700', '0.0949091', '0.0949091', '0.0982800', '0.0982800', '0.0991059', '0.0991059', '0.1016400', '0.1020000', '0.1020000', '0.1027317', '0.1027317', '0.1027317', '0.1053000', '0.1053000', '0.1056000', '0.1056000', '0.1058087', '0.1058087', '0.1079000', '0.1080000', '0.1092000', '0.1092000', '0.1111500', '0.1111500', '0.1123200', '0.1123200', '0.1123200', '0.1123200', '0.1144000', '0.1144000', '0.1150244', '0.1182600', '0.1182600', '0.1200500', '0.1204875', '0.1248000', '0.1248000', '0.1248000', '0.1260000', '0.1263600', '0.1263600', '0.1263600', '0.1281600', '0.1386000', '0.1386000', '0.1435000', '0.1435000', '0.1435000', '0.1440000', '0.1440000', '0.1443000', '0.1443000', '0.1474200', '0.1474200', '0.1478400', '0.1523400', '0.1523400', '0.1558000', '0.1581462', '0.1581462', '0.1598049', '0.1598049', '0.1598049', '0.1647360', '0.1647360', '0.1737000', '0.1737000', '0.1739927', '0.1739927', '0.1856000', '0.1864350', '0.1928348', '0.1928348', '0.1940400', '0.1940400', '0.1940400', '0.1940400', '0.1940400', '0.1995840', '0.1995840', '0.2106000', '0.2106000', '0.2160000', '0.2160000', '0.2217600', '0.2217600', '0.2273166', '0.2587200', '0.2587200', '0.2765854', '0.2772000', '0.2772000', '0.2947500', '0.2988000', '0.2988000', '0.3053700', '0.3275122', '0.3326400', '0.3326400', '0.3326400', '0.3386488', '0.3386488', '0.3420000', '0.3551707', '0.3790800', '0.3856696', '0.3856696', '0.3856696', '0.3856696', '0.3869217', '0.3869217', '0.3952800', '0.3952800', '0.3981600', '0.3981600', '0.4056585', '0.4158000', '0.4164000', '0.4164000', '0.4435200', '0.4435200', '0.4435200', '0.4435200', '0.4492800', '0.4504500', '0.4504500', '0.4716000', '0.4758000', '0.4758000', '0.5161655', '0.5197500', '0.5197500', '0.5544000', '0.5544000', '0.5544000', '0.5544000', '0.5661000', '0.5661000', '0.5670000', '0.5670000', '0.5785043', '0.5785043', '0.5785043', '0.5985000', '0.5985000', '0.6084878', '0.6084878', '0.6084878', '0.6084878', '0.6084878', '0.6084878', '0.6237000', '0.6237000', '0.6433920', '0.6433920', '0.6652800', '0.6652800', '0.6652800', '0.6716769', '0.6716769', '0.6716769', '0.6760976', '0.6760976', '0.6760976', '0.6780209', '0.6780209', '0.6793200', '0.7281000', '0.7484400', '0.7484400', '0.7484400', '0.7484400', '0.7546000', '0.7623000', '0.7713391', '0.8316000', '0.8731800', '0.8731800', '0.8837100', '0.8837100', '0.8870400', '0.8870400', '0.8870400', '0.8870400', '0.9009000', '0.9115615', '0.9240000', '0.9240000', '0.9355500', '0.9355500', '0.9504000', '0.9504000', '0.9504000', '1.0164000', '1.0741500', '1.0741500', '1.0841600', '1.1064683', '1.1064683', '1.1088000', '1.1088000', '1.1088000', '1.1088000', '1.1088000', '1.1340000', '1.1340000', '1.1473000', '1.1531520', '1.1531520', '1.1880000', '1.2000000', '1.2000000', '1.2000000', '1.2000000', '1.3065300', '1.5214500', '1.5214500', '1.6704800', '1.6704800', '1.7151750', '1.7151750', '1.8585000', '1.8585000', '2.3562000', '2.3562000', '2.4570000', '3.0769200', '10.9661538', '10.9661538', '10.9661538', '33.6461538']

'''  # old risk and damage reference data(v1.1.0)

        def hsv2rgb(h, s, v):
            return tuple(int(i * 255) for i in colorsys.hsv_to_rgb(h, s, v))

        color_HSV = []

        for n in range(110, 10, -1):  # reversed order of range
            H = n / 360.0
            S = 1
            V = 1
            R, G, B = hsv2rgb(H, S, V)
            packed = str('#%02x%02x%02x' % (R, G, B))
            color_HSV.append(str(packed))

        color_HSV_new = []

        for i in range(len(color_HSV)):
            if i < 5:
                color_HSV_new.append(color_HSV[i])
            elif i % 2 != 0 and i < 52 and i > 5:  # - 26
                color_HSV_new.append(color_HSV[i])
            elif i >= 52 and i < 62:  # + 5
                color_HSV_new.append(color_HSV[i])
                if i % 2 == 0:
                    color_HSV_new.append(color_HSV[i])
            elif i >= 62 and i % 3 == 0:  # - 26
                color_HSV_new.append(color_HSV[i])


        color_HSV_new = color_HSV_new + [color_HSV[-1]] * 49

        self.color_list = color_HSV_new
        self.out_range_colorlist = ['#ff2e00']

        #print(len(self.color_list))

    def riskFromDamage(self, damage_input): # return prob(injury + pain last year)
        cd = math.log(damage_input, 10)
        # y = 0.596 + 0.75 * cd   #version 1.2.0
        y = 0.573 + 0.747 * cd
        p = math.exp(y) / (1 + math.exp(y))
        return p


    # version 1.2.0
    def colorFromDamageRisk(self, damage_input):
        d = damage_input
        if d < 0.00002:
            return self.color_list[0]
        elif d > 136:
            return self.color_list[-1]
        else:
            risk_value = self.riskFromDamage(damage_input)
            risk_index = int(risk_value * 100)
            return self.color_list[risk_index]

    def calculate(self):

        scale = self.scale
        rep = self.rep

        d_percycle = self.Borg_Scale_index[int(scale)]

        task_damge = round((d_percycle * rep), 5)

        color = self.colorFromDamageRisk(task_damge)

        return task_damge, color


               
                    
                

          
       
   
